<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
      <title>丛林闲居-注册</title>
    <link rel="stylesheet" th:href="@{before/style/cy.css}">
    <link rel="stylesheet" th:href="@{before/style/style.css}">
    <link rel="stylesheet" th:href="@{webjars/layui/2.3.0/css/layui.css}">
<!-- 表单验证start -->
    <script type="text/javascript" th:src="@{webjars/jquery/3.0.0/jquery.js}"></script>
    <script type="text/javascript" th:src="@{webjars/layui/2.3.0/layui.js}"></script>
<script th:src="@{before/js/jquery.validate.js}"></script>
<script th:src="@{before/js/jquery.metadata.js}"></script>
<!-- 表单验证stop -->
</head>
<body>
<!--登录页TOP-->
<div class="index-top1">
    <div class="left">
        <span class="one"><a href="#" ><img th:src="@{before/images/logo1.png}" height="64px" width="158px"></a></span>
    </div>
    <div class="right1">
        <div class="three1">
            <span><img th:src="@{before/images/index_03.png}"></span>
            <ul>
                <li class="rx">客户服务热线:</li>
                <li class="phone">400-688-6798</li>
            </ul>
        </div>
    </div>
</div>
<div class="reg">
    <div class="reg-main">
        <p class="top"><img th:src="@{before/images/09.png}">注册新用户 <i>已有帐号？去<a th:href="@{/login}">登录</a> > </i></p>
        <!--<form action="<%=path %>/reguser!saveReguser.action" id="reguserForm">-->
        <!--<table> -->
            <!--<tr>  -->
                <!--<td class="with">手机号</td> -->
                <!--<td colspan="2"><input type="text" id="mobile"  name="mobile" size="32" maxlength="11" placeholder="请输入11位手机号码"  onblur="checkMobile()"><i>*</i></td>-->
				<!--<td  class="status" style="color: red" id="td1"></td>-->
            <!--</tr>-->
            <!--<tr>-->
                <!--<td class="with">短信验证码</td>-->
                <!--<td>-->
                    <!--<input id="mobileYZM" type="text" maxlength="6" size="28" placeholder="请输入6位短信验证码" onblur="checkYZM()"><i>*</i>-->
                <!--</td> -->
                <!--<td>&lt;!&ndash; <a href="#" class="hqyzm" onclick="getNumRandom()">获取验证码</a> &ndash;&gt;-->
                	<!--<button type="button" id="hqyzmbutton" onclick="getNumRandom()">获取验证码</button> -->
                <!--</td>-->
				<!--<td class="status" style="color: red" id="td2"></td>-->
            <!--</tr>-->
            <!--<tr>-->
                <!--<td class="with">邮箱</td>-->
                <!--<td colspan="2">-->
                    <!--<input name="email" id="email" type="text" size="70" placeholder="请输入邮箱地址" class="required email"><i>*</i>-->
                <!--</td>-->
                <!--<td class="status" style="color: red"></td>-->
            <!--</tr>-->
            <!--<tr>-->
                <!--<td class="with">密码</td>-->
                <!--<td colspan="2">-->
                    <!--<input type="password"  size="70"  placeholder="请输入原始密码" name="password" id="password" class="{required:true,minlength:6}" maxlength="16"><i>*</i>-->
                <!--</td>-->
                <!--<td class="status" style="color: red"></td>-->

            <!--</tr>-->
            <!--&lt;!&ndash; 没必要 &ndash;&gt;-->
            <!--&lt;!&ndash; <tr>-->
                <!--<td></td>-->
                <!--<td colspan="3">-->
                    <!--<p class="one">弱</p><p class="two">中</p><p class="two">强</p>-->
                <!--</td>-->
            <!--</tr> &ndash;&gt;-->
            <!--<tr>-->
                <!--<td  class="with" >确认密码</td> -->
                <!--<td colspan="2">-->
                    <!--<input type="password" size="70" name="repassword"  placeholder="请再次输入原始密码"  class="{required:true,minlength:6,equalTo:'#password'}" maxlength="16"><i>*</i>-->
                <!--</td>-->
                <!--<td class="status" style="color: red"></td>-->
            <!--</tr>-->
            <!--&lt;!&ndash; 不需要了 &ndash;&gt;-->
           <!--&lt;!&ndash;  <tr>-->
                <!--<td></td>-->
                <!--<td colspan="2" class="xy">-->
                    <!--<input type="checkbox">同意接受丛林闲居发送的促销信息-->
                <!--</td>-->
            <!--</tr> &ndash;&gt;-->
            <!--<tr>-->
                <!--<td></td>-->
                <!--<td colspan="2">-->
                    <!--<input type="button" value="马上注册" class="mszc" onclick="subForm()">-->
                <!--</td>-->
            <!--</tr>-->
        <!--</table>-->
        <!--</form>-->
        <form class="layui-form layui-form-pane" action="">
            <div class="layui-form-item" style="margin-left: 130px;margin-top: 50px;margin-right: 400px;">
                <label class="layui-form-label" style="background: #4eadf2">邮箱</label>
                <div class="layui-input-block">
                    <input type="text" name="email" required lay-verify="required|email" placeholder="请确认邮箱" autocomplete="off" class="layui-input">
                </div>
            </div>
            <div class="layui-form-item" style="margin-left: 130px;margin-right: 300px;">
                <div class="layui-inline" >
                    <label class="layui-form-label" style="background: #4eadf2">验证码</label>
                    <div class="layui-input-inline">
                        <input type="text" name="code" id="code"  class="layui-input" placeholder="请输入验证码">
                    </div>
                </div>
                <div class="layui-inline" style="margin-left: 58px;">
                <input type="button" onclick="sendEmail(this)" id="email" class="layui-btn layui-btn-radius layui-btn-normal" value="发送验证码"/>
                </div>
            </div>
            <div class="layui-form-item" style="margin-left: 130px;margin-right: 400px;">
                <label class="layui-form-label" style="background: #4eadf2">密码</label>
                <div class="layui-input-block">
                    <input type="password" name="pwd" required lay-verify="required" placeholder="请输入密码" autocomplete="off" class="layui-input">
                </div>
            </div>
            <div class="layui-form-item" style="margin-left: 130px;margin-right: 400px;">
                <label class="layui-form-label" style="background: #4eadf2">确认密码</label>
                <div class="layui-input-block">
                    <input type="password" name="pwd2" required lay-verify="required" placeholder="请确认密码" autocomplete="off" class="layui-input">
                </div>
            </div>
            <div class="layui-form-item" style="margin-left: 130px;margin-left: 130px;">
                <div class="layui-input-block" style="margin-top: 50px">
                    <button style="margin-right: 100px" class="layui-btn layui-btn-lg layui-btn-normal" lay-submit lay-filter="formDemo">注册</button>
                    <button type="reset" class="layui-btn layui-btn-lg layui-btn-normal">重置</button>
                </div>
            </div>
        </form>
    </div>
</div>
<!--<div id="show" class="tcc12 none" style="display: none;">-->
    <!--<div class="tx-ydm">-->
            <!--<p class="tx-sm"><span class="one"><img th:src="@{before/images/tx.png}">提示</span><span class="two"><img th:src="@{before/images/14_01.png}" class="close"></span></p><br/><br/><br/>-->
            <!--<p align="center">恭喜你，注册成功</p><br/><br/><br/>-->
            <!--<p align="center">点击<a href="login">登录</a>进入登录页面</p>-->
    <!--</div>-->
<!--</div>-->
<!--<div id="show2" class="tcc12"   style="display: none;">  -->
    <!--<div class="tx-ydm" style="margin-top:250px;">-->
            <!--<p class="tx-sm"><span class="one"><img th:src="@{before/images/tx.png}">提示</span><span class="two"><img th:src="@{before/images/14_01.png}" class="close"></span></p><br/><br/><br/>-->
            <!--<p align="center">哦。。。发生了点小意外，不好意思</p><br/><br/><br/>-->
            <!--<p align="center">点击<a href="register.html">注册</a>刷新页面</p>-->
    <!--</div>-->
<!--</div>-->
<footer style="margin-bottom: 10px">
    <ul>
        <li>江西省丛林闲居投资有限公司，工业和信息化部网站备案许可证编号：赣ICP备15010915号</li>
        <li>Copyright © 2015 <a href="#">丛林闲居</a>  版权所有 3wcl.com | 客服中心：400-688-6798</li>
    </ul>
    <p><a href="#"><img th:src="@{before/images/index_48.jpg}"></a><a href="#"><img th:src="@{before/images/index_50.jpg}"></a><a href="#"><img th:src="@{before/images/index_52.jpg}"></a> <a href="#"><img th:src="@{before/images/index_54.jpg}"></a><a href="#"><img th:src="@{before/images/index_56.jpg}"></a> <a href="#"><img th:src="@{before/images/index_58.jpg}"></a>    </p>
</footer>
<script type="text/javascript">
    var wait=120;
    layui.use('form', function(){
        var form = layui.form;
        //监听提交
        form.on('submit(formDemo)', function(data){
            var msg = JSON.stringify(data.field);
            if(data.field.pwd!=data.field.pwd2){
                layer.msg("两次密码输入不一致");
                return false;
            }
            $.ajax({
                url: "/register",
                type: "post",
                async: true,
                data:{
                    email:data.field.email,
                    pwd:data.field.pwd,
                    code:data.field.code
                },
                success: function (data) {
                    if(data==true){
                        layer.msg("注册成功", {icon: 1});
                    }else {
                        layer.msg(data.msg, {icon: 5});
                    }
                },
                error: function () {
                }
            })
            return false;
        });

    });
    function sendEmail(o) {
        var email =$("input[name='email']").val();
        if(email==null||email==""){
            layer.msg("请输入邮箱");
            return false;
        }

        $.ajax({
            url: "/email/"+email,
            type: "post",
            async: true,
            success: function (data) {

            },
            error: function () {
            }
        })
        time(o);
    }
    //倒计时按钮
    function time(o) {
        if (wait == 0) {
            o.removeAttribute("disabled");
            //o.innerHTML="免费获取验证码";
            $("#email").val("发送验证码");
            wait = 120;
        } else {
            o.setAttribute("disabled", true);
            //o.innerHTML="重新发送(" + wait + ")";
            $("#email").val("重新发送(" + wait + ")");
            wait--;
            setTimeout(function() {
                    time(o)
                }, 1000)
        }
    }
// var checks = 0; //一个全局变量，用来最终判断表单是否可以提交
 //var wait=120;//倒计时获取验证码时间
// $(document).ready(function(){
// 	$("#reguserForm").validate({
// 		errorPlacement: function(error,element) {
//         if ( element.is(":radio") )
//             error.appendTo( element.parent().next().next() );
//         else if ( element.is(":checkbox") )
//             error.appendTo ( element.next() );
//         else
//             error.appendTo( element.parent().next() );
//     	}
// 	});
// 	jQuery.extend(jQuery.validator.messages, {
// 	    required: "&nbsp;&nbsp;该字段不能为空",
// 		email: "&nbsp;&nbsp;请输入正确格式的电子邮件",
// 		minlength: jQuery.validator.format("&nbsp;&nbsp;请输入一个长度最少是 {0} 的字符串"),
// 		equalTo:"&nbsp;&nbsp;两次输入密码不一致"
// 	});
// 	$(".close").click(function(){
// 	    $(".tcc").css("display","none");
// 	    window.location.href="<%=path%>/register.jsp";
// 	});
// });
// //检验手机号码是否已经被注册
// function checkMobile(){
// 	var mobile = document.getElementById("mobile").value;
// 	var check = !!mobile.match(/^(0|86|17951)?(13[0-9]|15[012356789]|17[678]|18[0-9]|14[57])[0-9]{8}$/);
// 	var td1 = document.getElementById("td1");
// 	if(mobile==""){
// 		td1.innerHTML="&nbsp;&nbsp;手机号不能为空";
// 		checks = 0;
// 	}else if(check==false){
// 		td1.innerHTML="&nbsp;&nbsp;请正确填写您的手机号码";
// 		checks = 0;
// 	}else{
// 		$.post("<%=path %>/reguser!checkMobile.action",
// 				  {"reguser.username":mobile},
// 				  function(result){
// 					  if(result == null){
// 						  checks = 0;
// 						  td1.innerHTML = "&nbsp;&nbsp该号码无法注册,请更换";
// 					  }
// 					  if(result.status=="true"||result.status==true){
// 						  checks = 1;
// 						  td1.innerHTML = result.message;
// 					  }else{
// 						  checks = 0;
// 						  td1.innerHTML = result.message;
// 					  }
// 				  },"json");
// 	}
// }
// //获取手机验证码
// function getNumRandom(){
// 	var mobile = document.getElementById("mobile").value;
// 	var check = !!mobile.match(/^(0|86|17951)?(13[0-9]|15[012356789]|17[678]|18[0-9]|14[57])[0-9]{8}$/);
// 	var td1 = document.getElementById("td1");
// 	var button = document.getElementById("hqyzmbutton");
// 	var td2 = document.getElementById("td2");
// 	if(mobile==""){
// 		td1.innerHTML="&nbsp;&nbsp;手机号不能为空";
// 		checks = 0;
// 	}else if(check==false){
// 		td1.innerHTML="&nbsp;&nbsp;请正确填写您的手机号码";
// 		checks = 0;
// 	}else{
// 		checkMobile();
// 		if(checks){
// 			time(button);
// 			$.post("<%=path %>/reguser!checkMobile.action",
// 					  {"reguser.username":mobile},
// 					  function(result){
// 						  if(result == null){
// 							  checks = 0;
// 							  td1.innerHTML = "&nbsp;&nbsp该号码无法注册,请更换";
// 						  }
// 						  if(result.status=="true"||result.status==true){
// 							  $.post("<%=path %>/reguser!getNumRandom.action",
// 										{"reguser.username":mobile},
// 										  function(result){
// 											  if(result == null){
// 												  td2.innerHTML = "服务器发生了点小意外，请刷新页面试试";
// 												  checks = 0;
// 											  }
// 											  if(result.status=="true"||result.status==true){
// 												  td2.innerHTML = result.message;
// 												  checks = 1;
// 											  }else{
// 												  td2.innerHTML = result.message;
// 												  checks = 0;
// 											  }
// 										  },"json");
// 						  }else{
// 							  checks = 0;
// 							  td1.innerHTML = result.message;
// 						  }
// 					  },"json");
// 			}
// 	}
// }

// //检验验证码是否正确
// function checkYZM(){
// 	var mobile = document.getElementById("mobile").value;
// 	var mobileYZM = document.getElementById("mobileYZM").value;
// 	var check = !!mobileYZM.match(/^\d{6}$/);
// 	var td2 = document.getElementById("td2");
// 	if(mobileYZM==""){
// 		td2.innerHTML="&nbsp;&nbsp;验证码不能为空";
// 		checks = 0;
// 	}else if(check==false){
// 		td2.innerHTML="&nbsp;&nbsp;请正确输入6位纯数字验证码";
// 		checks = 0;
// 	}else{
// 		$.post("<%=path %>/reguser!checkYZM.action",
// 				  {"mobileYZM":mobileYZM,"reguser.username":mobile},
// 				  function(result){
// 					  if(result == null){
// 						  td2.innerHTML = "&nbsp;&nbsp验证出错，请重试";
// 						  checks = 0;
// 					  }
// 					  if(result.status=="true"||result.status==true){
// 						  td2.innerHTML = result.message;
// 						  checks = 1;
// 					  }else{
// 						  td2.innerHTML = result.message;
// 						  checks = 0;
// 					  }
// 				  },"json");
// 	}
// }
// //提交表单
// function subForm(){
// 	checkMobile();
// 	if(checks==1){
// 	checkYZM();
// 	}else{
// 	var valid = $("#reguserForm").valid();
// 	if(checks==1){
// 		if(valid){
// 			var mobile = document.getElementById("mobile").value;
// 			var email = document.getElementById("email").value;
// 			var pwd = document.getElementById("password").value;
// 			$.post("<%=path %>/reguser!saveReguser.action",
// 					   {"reguser.username":mobile,"reguser.email":email,"reguser.pwd":pwd},
// 					  function(result){
// 						  if(result == null){
// 							  registerNo();
// 						  }
// 						  if(result.status=="true"||result.status==true){
// 							  registerOk();
// 						  }else{
// 							  registerNo();
// 						  }
// 					  },"json");
// 			}
// 		}
// 	}
// }
// //注册成功
// function registerOk(){
// 	var show = document.getElementById("show");
// 	show.style.display="block";
// }
// function registerNo(){
// 	var show2 = document.getElementById("show2");
// 	show2.style.display="block";
// }
</script>
</body>
</html>